<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>
        <%= title %>
    </title>
    <link rel="icon" type="image/png" href="/images/LogoGPX.png">
    <link rel='stylesheet' href='/stylesheets/style.css' />
    <link rel='stylesheet' href='/stylesheets/deposit.css' />
</head>

<body>
    <video autoplay muted loop class="video-background">
        <source src="/images/FondoPagina.mp4" type="video/mp4">
        Tu navegador no soporta el video de fondo.
    </video>

    <%- include('partials/header') %>

        <div class="page-container">
            <h1 class="page-title">Depositar fondos</h1>

            <p class="page-subtitle">
                Añade saldo ficticio a tu cuenta (proyecto educativo).
            </p>

            <% if (typeof error !=='undefined' && error) { %>
                <div class="alert alert-error">
                    <%= error %>
                </div>
                <% } %>

                    <% if (typeof success !=='undefined' && success) { %>
                        <div class="alert alert-success">
                            <%= success %>
                        </div>
                        <% } %>


                            <div class="card deposit-card">
                                <div class="balance-info">
                                    <div>
                                        <span>Saldo EUR</span>
                                        <strong>
                                            <%= user.balance?.eur?.toFixed(2) || '0.00' %> €
                                        </strong>
                                    </div>
                                    <div>
                                        <span>Saldo BTC</span>
                                        <strong>
                                            <%= user.balance?.btc || 0 %> BTC
                                        </strong>
                                    </div>
                                </div>

                                <form method="POST" action="/deposit" class="deposit-form">
                                    <div class="form-group">
                                        <label>Cantidad</label>
                                        <input type="text" name="amount" placeholder="Ej: 100" required />
                                    </div>

                                    <div class="form-group">
                                        <label>Moneda</label>
                                        <select name="currency">
                                            <!-- € por defecto -->
                                            <option value="eur">EUR</option>

                                            <!-- Otras monedas disponibles en el sistema -->
                                            <% if (typeof coins !== 'undefined' && coins && coins.length) { %>
                                                <% coins.forEach(function(coin) { 
                                                    const symbol = String(coin.symbol || '').toLowerCase();
                                                    if (symbol === 'eur') return;
                                                %>
                                                    <option value="<%= symbol %>">
                                                        <%= coin.symbol %> - <%= coin.name %>
                                                    </option>
                                                <% }); %>
                                            <% } %>
                                        </select>
                                    </div>

                                    <button type="submit" class="btn btn-primary full-width">
                                        Depositar
                                    </button>
                                </form>
                            </div>
        </div>


        <%- include('partials/footer') %>

</body>

</html>